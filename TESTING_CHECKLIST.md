# Meme Maker 插件测试清单

本文档提供了完整的测试指南，确保插件功能正常工作。

## 环境准备

### 基础环境检查
- [ ] Python 3.8+ 已安装
- [ ] AstrBot 框架正常运行
- [ ] 插件已正确放置到插件目录
- [ ] 依赖包已安装（requirements.txt 中的所有包）

### 目录结构检查
- [ ] 插件目录结构完整
- [ ] scripts/gen_checksum.py 文件存在且可执行
- [ ] requirements.txt 文件存在
- [ ] README.md 文件完整

## 功能测试

### 1. 插件初始化测试

#### 启动测试
- [ ] 插件能够正常加载
- [ ] 无错误日志输出
- [ ] 数据目录自动创建
- [ ] 默认配置文件生成

#### 配置加载测试
- [ ] 默认配置正确加载
- [ ] 日志显示加载的表情包数量
- [ ] 快捷方式正确注册

### 2. 基础命令测试

#### 表情包生成命令
```bash
# 测试默认表情包
/doge 测试文字
/cat 测试文字

# 预期结果：
# - 返回格式化的表情包文本
# - 无错误信息
# - 响应时间合理
```
- [ ] `/doge` 命令正常响应
- [ ] `/cat` 命令正常响应
- [ ] 带参数的命令正常工作
- [ ] 无参数时显示帮助信息

#### 管理命令测试
```bash
# 测试状态查询
/meme status

# 测试包列表
/meme list

# 测试帮助信息
/meme
```
- [ ] `/meme status` 显示正确状态
- [ ] `/meme list` 显示表情包列表
- [ ] `/meme` 显示帮助信息

### 3. 动态注册测试

#### 包启用/禁用测试
```bash
# 禁用默认包
/meme disable default

# 测试命令是否失效
/doge 测试文字

# 重新启用
/meme enable default

# 测试命令是否恢复
/doge 测试文字
```
- [ ] 禁用包后快捷方式失效
- [ ] 启用包后快捷方式恢复
- [ ] 状态信息正确更新

#### 配置重载测试
```bash
# 修改配置文件（手动添加新包或修改现有包）
# 然后重载
/meme reload
```
- [ ] 配置重载成功
- [ ] 新配置正确生效
- [ ] 命令注册状态正确

### 4. 错误处理测试

#### 异常情况测试
- [ ] 无效命令处理
- [ ] 不存在的包名处理
- [ ] 配置文件损坏处理
- [ ] 权限不足处理

#### 重试机制测试
- [ ] 网络请求失败重试
- [ ] 文件操作失败重试
- [ ] 临时错误恢复

## 性能测试

### 1. 响应时间测试
- [ ] 命令响应时间 < 2秒
- [ ] 配置加载时间合理
- [ ] 大量表情包加载时间可接受

### 2. 内存使用测试
- [ ] 插件内存占用稳定
- [ ] 无内存泄漏
- [ ] 长时间运行稳定

### 3. 并发测试
- [ ] 多用户同时使用
- [ ] 并发命令处理
- [ ] 高频调用稳定性

## 兼容性测试

### 1. AstrBot 版本兼容性
- [ ] 兼容最新版本 AstrBot
- [ ] 兼容较旧版本（如果可能）
- [ ] API 接口兼容性

### 2. 平台兼容性
- [ ] Linux 环境正常运行
- [ ] Windows 环境正常运行
- [ ] macOS 环境正常运行

### 3. Python 版本兼容性
- [ ] Python 3.8 兼容
- [ ] Python 3.9+ 兼容
- [ ] 依赖包版本兼容

## 安全测试

### 1. 输入验证
- [ ] 恶意输入过滤
- [ ] 路径遍历防护
- [ ] 命令注入防护

### 2. 文件安全
- [ ] 文件权限检查
- [ ] 文件大小限制
- [ ] 文件类型验证

### 3. 配置安全
- [ ] 配置文件权限
- [ ] 敏感信息保护
- [ ] 配置验证

## 用户体验测试

### 1. 错误信息
- [ ] 错误信息清晰易懂
- [ ] 帮助信息完整
- [ ] 提示信息友好

### 2. 文档完整性
- [ ] README.md 内容准确
- [ ] 安装说明清晰
- [ ] 使用示例正确

### 3. 日志质量
- [ ] 日志信息详细
- [ ] 调试信息有用
- [ ] 错误日志可追踪

## 回归测试

### 1. 版本升级测试
- [ ] 从旧版本升级正常
- [ ] 配置文件兼容
- [ ] 数据迁移正常

### 2. 功能回归
- [ ] 原有功能正常
- [ ] 新功能不影响旧功能
- [ ] 性能无明显下降

## 压力测试

### 1. 大量数据测试
- [ ] 大量表情包加载
- [ ] 大量配置项处理
- [ ] 长时间运行稳定性

### 2. 高频调用测试
- [ ] 频繁命令调用
- [ ] 频繁配置更改
- [ ] 频繁重载操作

## 测试工具和脚本

### 自动化测试
```bash
# 运行校验和生成脚本
python scripts/gen_checksum.py

# 检查配置文件格式
python -m json.tool data/config.json

# 检查依赖安装
pip check
```

### 手动测试脚本
创建测试脚本自动化基本功能测试：

```python
# test_basic_functionality.py
import asyncio
import json
from pathlib import Path

async def test_basic_commands():
    """测试基本命令功能"""
    # 这里可以添加自动化测试逻辑
    pass

if __name__ == "__main__":
    asyncio.run(test_basic_commands())
```

## 测试报告模板

### 测试结果记录
```
测试日期: ____
测试环境: ____
测试人员: ____

功能测试:
- 初始化: [通过/失败]
- 基础命令: [通过/失败]
- 动态注册: [通过/失败]
- 错误处理: [通过/失败]

性能测试:
- 响应时间: ____ms
- 内存占用: ____MB
- 并发处理: [通过/失败]

兼容性测试:
- AstrBot版本: ____
- 操作系统: ____
- Python版本: ____

发现的问题:
1. ____
2. ____

建议改进:
1. ____
2. ____
```

## 测试完成标准

### 发布前必须通过的测试
- [ ] 所有功能测试通过
- [ ] 性能测试满足要求
- [ ] 兼容性测试通过
- [ ] 安全测试无严重问题
- [ ] 文档更新完整

### 发布建议
- [ ] 在测试环境充分验证
- [ ] 备份生产环境配置
- [ ] 准备回滚方案
- [ ] 监控部署后状态

## 常见问题排查

### 测试失败排查步骤
1. 检查日志输出
2. 验证配置文件格式
3. 确认依赖安装
4. 检查文件权限
5. 验证 AstrBot 版本

### 性能问题排查
1. 监控资源使用
2. 分析响应时间
3. 检查并发处理
4. 优化代码路径

---

**注意**: 本测试清单应该在实际使用中根据具体情况进行调整和补充。